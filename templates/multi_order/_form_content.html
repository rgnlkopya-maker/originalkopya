<form method="POST">
    {% csrf_token %}

    <!-- Ãœst Form (SipariÅŸ tipi / MÃ¼ÅŸteri / ÃœrÃ¼n Kodu) -->
    <div class="row mb-4">
        <div class="col-md-4">
            <label class="form-label">SipariÅŸ Tipi</label>
            <select id="siparis_tipi_select" name="siparis_tipi" class="form-select" required>
                <option value="SERI">Seri</option>
                <option value="STOK">StoÄŸa Ãœretim</option>
                <option value="OZEL">Ã–zel SipariÅŸ</option>
            </select>
        </div>

        <div class="col-md-4">
            <label class="form-label">MÃ¼ÅŸteri</label>
            <select id="musteri_select" name="musteri" class="form-select select2" required>
                <option></option>
                {% for m in musteriler %}
                    <option value="{{ m.id }}">{{ m.ad }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="col-md-4">
            <label class="form-label">ÃœrÃ¼n Kodu</label>
            <select id="urun_kodu_select" name="urun_kodu" class="form-select select2" required>
                <option></option>
                {% for u in urun_kodlari %}
                    <option value="{{ u.kod }}">{{ u.kod }}</option>
                {% endfor %}
            </select>
        </div>
    </div>

    <hr>

    <!-- Renk Beden BaÅŸlÄ±k -->
    <h5 class="section-title d-flex justify-content-between align-items-center">
        <span>Renk - Beden SatÄ±rlarÄ±</span>

        <span class="d-flex gap-2">
            <button type="button" class="manage-btn" data-bs-toggle="modal" data-bs-target="#renkModal">ğŸ¨ Renk YÃ¶net</button>
            <button type="button" class="manage-btn" data-bs-toggle="modal" data-bs-target="#bedenModal">ğŸ‘• Beden YÃ¶net</button>
            <button type="button" class="manage-btn" data-bs-toggle="modal" data-bs-target="#musteriModal">ğŸ§ MÃ¼ÅŸteri YÃ¶net</button>
            <button type="button" class="manage-btn" data-bs-toggle="modal" data-bs-target="#urunKodModal">ğŸ“¦ ÃœrÃ¼n Kodu YÃ¶net</button>
        </span>
    </h5>

    <!-- SatÄ±rlar -->
    <div id="rows-container">
        <div class="renk-beden-card renk-beden-row" data-index="0">

            <div class="row">
                <div class="col-md-3">
                    <label class="form-label">Renk</label>
                    <select name="renk_row_0" class="form-select select2 renk-select">
                        <option></option>
                        {% for r in renkler %}
                            <option value="{{ r.ad }}">{{ r.ad }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="col-md-4">
                    <label class="form-label">Bedenler</label>
                    <select name="beden_row_0[]" class="form-select select2 beden-select" multiple>
                        {% for b in bedenler %}
                            <option value="{{ b.ad }}">{{ b.ad }}</option>
                        {% endfor %}
                    </select>
                </div>

                <div class="col-md-2">
                    <label class="form-label">Adet</label>
                    <input type="number" min="1" value="1" name="adet_row_0" class="form-control">
                </div>

                <div class="col-md-3">
                    <label class="form-label">MÃ¼ÅŸteri ReferansÄ±</label>
                    <input type="text" name="musteri_ref_row_0" class="form-control" placeholder="Ã–rn: PO123">
                </div>
            </div>

            <div class="mt-3 text-end">
                <button type="button" class="btn btn-danger remove-row">Sil</button>
            </div>
        </div>
    </div>

    <button type="button" id="add-row" class="btn btn-success mt-2">+ SatÄ±r Ekle</button>

    <hr class="mt-4">

    <!-- Genel Alanlar -->
    <div class="sub-card mb-4">
        <div class="row">
            <div class="col-md-6">
                <label class="form-label fw-bold">Teslim Tarihi</label>
                <input type="date" name="teslim_tarihi" class="form-control">
            </div>

            <div class="col-md-6">
                <label class="form-label fw-bold">AÃ§Ä±klama</label>
                <input type="text" name="aciklama" class="form-control" placeholder="Opsiyonel">
            </div>
        </div>
    </div>

    {% if is_manager %}
    <div class="cost-card">
        <h5 class="section-title">ğŸ’° Fiyat & Maliyet Bilgileri</h5>

        <div class="row g-3 mt-1">
            <div class="col-md-4">
                <label class="form-label">SatÄ±ÅŸ FiyatÄ±</label>
                <input type="number" step="0.01" name="satis_fiyati" class="form-control">
            </div>

            <div class="col-md-2">
                <label class="form-label">Para</label>
                <input type="text" name="para_birimi" value="TRY" class="form-control">
            </div>

            <div class="col-md-4">
                <label class="form-label">Maliyet</label>
                <input type="number" step="0.01" name="maliyet_uygulanan" class="form-control">
            </div>

            <div class="col-md-2">
                <label class="form-label">Para</label>
                <input type="text" name="maliyet_para_birimi" value="TRY" class="form-control">
            </div>
        </div>
    </div>
    {% endif %}

    <div class="text-center mt-4">
        <button class="btn btn-primary px-5 py-2">ğŸš€ SipariÅŸleri OluÅŸtur</button>
    </div>
</form>

{% include "multi_order/_modals.html" %}
